<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introducción a las finanzas quantitativas</title>
  <meta name="description" content="Esto es un apunte en proceso pensado en el curso Finanza I de Ingeniería Comercial de la Universidad de Chile">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introducción a las finanzas quantitativas" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Esto es un apunte en proceso pensado en el curso Finanza I de Ingeniería Comercial de la Universidad de Chile" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introducción a las finanzas quantitativas" />
  
  <meta name="twitter:description" content="Esto es un apunte en proceso pensado en el curso Finanza I de Ingeniería Comercial de la Universidad de Chile" />
  

<meta name="author" content="Gabriel Cabrera G.">


<meta name="date" content="2018-09-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="portafolio.html">
<link rel="next" href="options.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Finance Rocks!!</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="sobre-el-autor.html"><a href="sobre-el-autor.html"><i class="fa fa-check"></i>Sobre el Autor</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#un-poco-de-historia"><i class="fa fa-check"></i><b>1.1.1</b> Un poco de historia</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#los-primeros-pasos"><i class="fa fa-check"></i><b>1.1.2</b> Los primeros pasos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#partes-de-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Partes de RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#scripts"><i class="fa fa-check"></i><b>1.3</b> <em>Scripts</em></a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#proyectos"><i class="fa fa-check"></i><b>1.4</b> Proyectos</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#por-que-esto-es-util"><i class="fa fa-check"></i><b>1.4.1</b> ¿Por qué esto es útil?</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#como-crear-un-projecto"><i class="fa fa-check"></i><b>1.4.2</b> ¿Cómo crear un projecto?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.5</b> <em>Packages</em></a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#tidyverse"><i class="fa fa-check"></i><b>1.5.1</b> <em>tidyverse</em></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#ejemplo"><i class="fa fa-check"></i><b>1.6</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quantmod.html"><a href="quantmod.html"><i class="fa fa-check"></i><b>2</b> Quantmod</a><ul>
<li class="chapter" data-level="2.1" data-path="quantmod.html"><a href="quantmod.html#que-es-quantmod"><i class="fa fa-check"></i><b>2.1</b> ¿Que es quantmod?</a></li>
<li class="chapter" data-level="2.2" data-path="quantmod.html"><a href="quantmod.html#obtencion-de-datos"><i class="fa fa-check"></i><b>2.2</b> Obtención de Datos</a><ul>
<li class="chapter" data-level="2.2.1" data-path="quantmod.html"><a href="quantmod.html#que-hizo-la-funcion-getsymbols"><i class="fa fa-check"></i><b>2.2.1</b> ¿Qué hizo la función <code>getSymbols</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="quantmod.html"><a href="quantmod.html#graficando-con-chartseries"><i class="fa fa-check"></i><b>2.3</b> Graficando con <code>chartSeries</code></a><ul>
<li class="chapter" data-level="2.3.1" data-path="quantmod.html"><a href="quantmod.html#chartseries"><i class="fa fa-check"></i><b>2.3.1</b> <code>chartSeries</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="quantmod.html"><a href="quantmod.html#graficando-con-ggplot2"><i class="fa fa-check"></i><b>2.4</b> Graficando con <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.4.1" data-path="quantmod.html"><a href="quantmod.html#breve-introduccion-a-ggplot2"><i class="fa fa-check"></i><b>2.4.1</b> Breve introducción a <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="quantmod.html"><a href="quantmod.html#color-tamano-forma-y-otros-atributos-del-aesthetic"><i class="fa fa-check"></i><b>2.4.2</b> Color, tamaño, forma y otros atributos del <em>aesthetic</em></a></li>
<li class="chapter" data-level="2.4.3" data-path="quantmod.html"><a href="quantmod.html#sp-500-con-ggplot2"><i class="fa fa-check"></i><b>2.4.3</b> S&amp;P 500 con <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="quantmod.html"><a href="quantmod.html#multiples-datos"><i class="fa fa-check"></i><b>2.5</b> Multiples Datos</a><ul>
<li class="chapter" data-level="2.5.1" data-path="quantmod.html"><a href="quantmod.html#retornos"><i class="fa fa-check"></i><b>2.5.1</b> Retornos</a></li>
<li class="chapter" data-level="2.5.2" data-path="quantmod.html"><a href="quantmod.html#retornos-acumulados"><i class="fa fa-check"></i><b>2.5.2</b> Retornos Acumulados</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="quantmod.html"><a href="quantmod.html#estadistica-descriptiva"><i class="fa fa-check"></i><b>2.6</b> Estadística Descriptiva</a></li>
<li class="chapter" data-level="2.7" data-path="quantmod.html"><a href="quantmod.html#ratio-de-sharpe"><i class="fa fa-check"></i><b>2.7</b> Ratio de Sharpe</a></li>
<li class="chapter" data-level="2.8" data-path="quantmod.html"><a href="quantmod.html#test-de-jarquebera"><i class="fa fa-check"></i><b>2.8</b> Test de JarqueBera</a></li>
<li class="chapter" data-level="2.9" data-path="quantmod.html"><a href="quantmod.html#recursos-del-capitulo"><i class="fa fa-check"></i><b>2.9</b> Recursos del capítulo</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="portafolio.html"><a href="portafolio.html"><i class="fa fa-check"></i><b>3</b> Introducción a teoría de portafolio</a><ul>
<li class="chapter" data-level="3.1" data-path="portafolio.html"><a href="portafolio.html#libreria-introcompfinr"><i class="fa fa-check"></i><b>3.1</b> Librería IntroCompFinR</a><ul>
<li class="chapter" data-level="3.1.1" data-path="portafolio.html"><a href="portafolio.html#funciones-utiles-de-introcompfinr"><i class="fa fa-check"></i><b>3.1.1</b> Funciones útiles de IntroCompFinR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="portafolio.html"><a href="portafolio.html#cargando-la-libreria-y-la-base-de-datos"><i class="fa fa-check"></i><b>3.2</b> Cargando la librería y la base de datos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bonos.html"><a href="bonos.html"><i class="fa fa-check"></i><b>4</b> Renta Fija</a><ul>
<li class="chapter" data-level="4.1" data-path="bonos.html"><a href="bonos.html#precio-de-un-bono"><i class="fa fa-check"></i><b>4.1</b> Precio de un Bono</a></li>
<li class="chapter" data-level="4.2" data-path="bonos.html"><a href="bonos.html#dos-formas-de-hacer-lo-mismo"><i class="fa fa-check"></i><b>4.2</b> Dos formas de hacer lo mismo</a></li>
<li class="chapter" data-level="4.3" data-path="bonos.html"><a href="bonos.html#funciones"><i class="fa fa-check"></i><b>4.3</b> funciones</a></li>
<li class="chapter" data-level="4.4" data-path="bonos.html"><a href="bonos.html#relacion-precio-del-bono-y-yield"><i class="fa fa-check"></i><b>4.4</b> Relación precio del Bono y Yield</a><ul>
<li class="chapter" data-level="4.4.1" data-path="bonos.html"><a href="bonos.html#valorizacion"><i class="fa fa-check"></i><b>4.4.1</b> Valorización</a></li>
<li class="chapter" data-level="4.4.2" data-path="bonos.html"><a href="bonos.html#construccion-yields"><i class="fa fa-check"></i><b>4.4.2</b> Construcción yields</a></li>
<li class="chapter" data-level="4.4.3" data-path="bonos.html"><a href="bonos.html#loops"><i class="fa fa-check"></i><b>4.4.3</b> Loops</a></li>
<li class="chapter" data-level="4.4.4" data-path="bonos.html"><a href="bonos.html#graficando"><i class="fa fa-check"></i><b>4.4.4</b> Graficando</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bonos.html"><a href="bonos.html#trabajando-con-yields-reales"><i class="fa fa-check"></i><b>4.5</b> Trabajando con yields reales</a></li>
<li class="chapter" data-level="4.6" data-path="bonos.html"><a href="bonos.html#duracion-y-convexidad-de-un-bono"><i class="fa fa-check"></i><b>4.6</b> Duración y Convexidad de un Bono</a><ul>
<li class="chapter" data-level="4.6.1" data-path="bonos.html"><a href="bonos.html#extracion-de-la-yield"><i class="fa fa-check"></i><b>4.6.1</b> Extración de la yield</a></li>
<li class="chapter" data-level="4.6.2" data-path="bonos.html"><a href="bonos.html#duracion"><i class="fa fa-check"></i><b>4.6.2</b> Duración</a></li>
<li class="chapter" data-level="4.6.3" data-path="bonos.html"><a href="bonos.html#duracion-con-libreria"><i class="fa fa-check"></i><b>4.6.3</b> Duración con librería</a></li>
<li class="chapter" data-level="4.6.4" data-path="bonos.html"><a href="bonos.html#convexidad"><i class="fa fa-check"></i><b>4.6.4</b> Convexidad</a></li>
<li class="chapter" data-level="4.6.5" data-path="bonos.html"><a href="bonos.html#convexidad-con-libreria"><i class="fa fa-check"></i><b>4.6.5</b> Convexidad con librería:</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="bonos.html"><a href="bonos.html#efecto-dolar"><i class="fa fa-check"></i><b>4.7</b> Efecto Dolar</a></li>
<li class="chapter" data-level="4.8" data-path="bonos.html"><a href="bonos.html#ejercicio"><i class="fa fa-check"></i><b>4.8</b> Ejercicio</a></li>
<li class="chapter" data-level="4.9" data-path="bonos.html"><a href="bonos.html#recursos-del-capitulo-1"><i class="fa fa-check"></i><b>4.9</b> Recursos del capítulo</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="options.html"><a href="options.html"><i class="fa fa-check"></i><b>5</b> Opciones, Derivados y Futuros</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción a las finanzas quantitativas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bonos" class="section level1">
<h1><span class="header-section-number">Capítulo 4</span> Renta Fija</h1>
<blockquote>
<p>IMPORTANTE: Aún no está del todo listo el formato en pdf, por lo que recomiendo verlo online.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)
<span class="kw">p_load</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;tidyquant&quot;</span>)</code></pre></div>
<div id="precio-de-un-bono" class="section level2">
<h2><span class="header-section-number">4.1</span> Precio de un Bono</h2>
<p>El precio de un bono se calcula como:</p>
<p><span class="math display">\[
P_{B} = \sum_{t=1}^{T} \frac{C}{(1+r)^t} + \frac{\text{ValorNominal}}{(1+r)^t}
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(P_B\)</span>: Precio del Bono</li>
<li><span class="math inline">\(C_t\)</span>: Pago interéses o cupones</li>
<li><span class="math inline">\(T\)</span> : Números de períodos o madurez</li>
<li><span class="math inline">\(r\)</span> : Tasa de descuento o yield-to-maturity semi-anual</li>
</ul>
<p>Considere el siguiente ejercicio: Calcular el precio de un bono con pago de cupón semestral, Madurez 25 años, Tasa cupón 6.5%, Yield semi-anual de 6.9% y Valor nominal de 100.</p>
<p>Para desarrollar el ejercicio, vamos a construir por parte los componentes de nuestro bono.</p>
<ol style="list-style-type: decimal">
<li>Construimos tanto la tasa cupón como la <em>Yield semi-anual</em>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tc &lt;-<span class="st"> </span><span class="fl">0.065</span>
y  &lt;-<span class="st"> </span><span class="fl">0.069</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Construimos un vector con los valores de los cupones más el principal</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pago &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(tc<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">49</span>),(<span class="dv">100</span> <span class="op">+</span><span class="st"> </span>tc<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="dv">2</span>))</code></pre></div>
<p>tanto <code>tc</code>, <code>r</code> y <code>pago</code> se encontraran en Values del global environment, en tipo <code>numeric</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Para poder trabajar con nuestra base de datos, transformamos nuestro vector <code>pago</code> que está en forma <code>numeric</code> a <code>data frame</code>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pago &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(pago)</code></pre></div>
<p>Ahora existe un objeto con estructuración de datos <code>data frame</code> en nuestro global environment. Se podría haber llamado de cualquier forma a nuestro nuevo objeto <code>pago</code>.</p>
</div>
<div id="dos-formas-de-hacer-lo-mismo" class="section level2">
<h2><span class="header-section-number">4.2</span> Dos formas de hacer lo mismo</h2>
<p>Ya construido nuestro objeto <code>pago</code> veremos que en <strong>R</strong> existen muchas formas de hacer lo mismo:</p>
<ol style="list-style-type: decimal">
<li>Al principio de la sesión cargamos la libreria <code>tidyverse</code>, está nos permitirá trabajar con un “megapaquete” que incluye otros paquetes en su interior (ggplot2, dplyr, magittr, entre otros). Todos los paquetes que conforman “el Tidyverse” comparten la misma visión sobre el trabajo con datos y la escritura de código. Si va a la pestaña packages y escribe <code>dplyr</code> verá que está activa, pero nunca la “llamamos”, esto se debe a <code>tidyverse</code> lo hizo por nosotros.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pago1 &lt;-<span class="st"> </span>pago <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">t1 =</span> <span class="kw">as.numeric</span>(<span class="kw">index</span>(pago)),<span class="dt">factor_desc =</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>(t1),
                <span class="dt">val_present =</span> pago<span class="op">*</span>factor_desc) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">summarise</span>(<span class="kw">sum</span>(val_present))</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>La otra forma es:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># replicamos el objeto</span>
pago2 &lt;-<span class="st"> </span>pago

pago2<span class="op">$</span>t2 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">rownames</span>(pago2))

<span class="co"># Calculamos el factor de descuento</span>
pago2<span class="op">$</span>factor_desc &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>r)<span class="op">^</span>(pago2<span class="op">$</span>t2)
<span class="co"># Calculamos el valor presente</span>
pago2<span class="op">$</span>val_present &lt;-<span class="st">  </span>pago<span class="op">$</span>pv_factor<span class="op">*</span>pago2<span class="op">$</span>pago
<span class="co"># Calculamos el precio</span>
<span class="kw">sum</span>(pago2<span class="op">$</span>val_present)</code></pre></div>
</div>
<div id="funciones" class="section level2">
<h2><span class="header-section-number">4.3</span> funciones</h2>
<p>Ahora se contruirá una función para valorizar cualquiee bono que pague cupones iguales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># p: valor nominal; tc: tasa cupón; t: madurez; y: yield to maturity</span>
precio.bono &lt;-<span class="st"> </span><span class="cf">function</span>(p,tc,t,y){
  <span class="co"># rep returns a vector with value = p * r and times = ttm -1 </span>
  pago   &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(tc<span class="op">*</span>p, t <span class="op">-</span><span class="st"> </span><span class="dv">1</span>),p<span class="op">*</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tc))
  pago   &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(pago)
  pago<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">rownames</span>(pago))
  pago<span class="op">$</span>factor_desc &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>y)<span class="op">^</span>(pago<span class="op">$</span>t)
  pago<span class="op">$</span>valor_prese &lt;-<span class="st"> </span>pago<span class="op">$</span>factor_desc<span class="op">*</span>pago<span class="op">$</span>pago
  <span class="kw">sum</span>(pago<span class="op">$</span>valor_prese)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">precio.bono</span>(<span class="dv">100</span>,<span class="fl">0.065</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">50</span>,<span class="fl">0.069</span><span class="op">/</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 95.27</code></pre>
</div>
<div id="relacion-precio-del-bono-y-yield" class="section level2">
<h2><span class="header-section-number">4.4</span> Relación precio del Bono y Yield</h2>
<div id="valorizacion" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Valorización</h3>
<p>Ahora utilizando la función <code>precio.bono</code> valorizaremos un bono con las siguientes características:</p>
<ul>
<li>Principal : 100</li>
<li>Tasa Cupón: 5%</li>
<li>Madurez: 10 años</li>
<li>Yield: 4.29%</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valoramos el siguiente Bono</span>
<span class="kw">precio.bono</span>(<span class="dt">p =</span> <span class="dv">100</span>, <span class="dt">tc =</span><span class="fl">0.05</span>, <span class="dt">t =</span><span class="dv">10</span>, <span class="dt">y =</span> <span class="fl">0.0429</span>)</code></pre></div>
<pre><code>## [1] 105.7</code></pre>
</div>
<div id="construccion-yields" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Construcción yields</h3>
<p>Se contruirá una secuencia de yields:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cosntruimos yields </span>
yields &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.02</span>, <span class="fl">0.4</span>, <span class="fl">0.01</span>)</code></pre></div>
<p>La función <code>seq</code> generá una secuencia. En este caso parte del 0.02 hasta el 0.4 pero con intervalos de 0.01.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convertimos yields a data frame como antes </span>
yields &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(yields)</code></pre></div>
</div>
<div id="loops" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Loops</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calaculamos el precio del bono para distintas yields</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(yields)) {
  yields<span class="op">$</span>precio[i] &lt;-<span class="st"> </span><span class="kw">precio.bono</span>(<span class="dv">100</span>, <span class="fl">0.10</span>, <span class="dv">20</span>, yields<span class="op">$</span>yields[i])  
}</code></pre></div>
</div>
<div id="graficando" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Graficando</h3>
<p>Una manera de visualizar datos es usar ggplot2, se recomienda que añadan por parte lo que desean en su gráfico.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Graficamos con ggplot2</span>
g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> yields,<span class="kw">aes</span>(<span class="dt">x =</span> yields<span class="op">*</span><span class="dv">100</span>, <span class="dt">y =</span> precio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) 
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relación inversa:&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Precio del Bono vs Yield&quot;</span>)
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Yield (%)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Precio del bono&quot;</span>) 
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">pmax</span>(precio,<span class="dv">0</span>)), <span class="dt">fill=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) 
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() 
g1 &lt;-<span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="fl">.5</span>),
                 <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#d3d3d3&quot;</span>))    
g1</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-39-1.png" alt="Relación Bono vs Yield" width="672" />
<p class="caption">
Figure 4.1: Relación Bono vs Yield
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Guarmados gráfico</span>
<span class="kw">ggsave</span>(<span class="st">&quot;retorno-yield.png&quot;</span>,<span class="dt">width =</span> <span class="fl">8.5</span>, <span class="dt">height =</span> <span class="fl">4.5</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</code></pre></div>
</div>
</div>
<div id="trabajando-con-yields-reales" class="section level2">
<h2><span class="header-section-number">4.5</span> Trabajando con yields reales</h2>
<p>quantmod es uno de las librerías más ocupadas en R para extraer datos financieros, te permite graficar, realizar análisis técnico, calcular retornos (<code>Delt(x)</code>), etc. Aunque las series son descargadas con estructura xts, la podemos transformar a data frame. A continuación descargaremos la yield de los bonos del tesoro de Estados Unidos a 10 años:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t10yr &lt;-<span class="st"> </span><span class="kw">getSymbols</span>(<span class="dt">Symbols =</span> <span class="st">&quot;DGS10&quot;</span>, <span class="dt">src =</span> <span class="st">&quot;FRED&quot;</span>, <span class="dt">auto.assign =</span> <span class="ot">FALSE</span>)

t10yr &lt;-<span class="st"> </span><span class="kw">subset</span>(t10yr[<span class="st">&quot;2000-01-01/2018-04-17&quot;</span>])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Grafico con chartSeries de quantmod solo funciona con xts</span>
<span class="kw">chartSeries</span>(t10yr,  <span class="dt">theme =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-41"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-41-1.png" alt="yield del tesoro de los Estados Unidos con chartSeries" width="672" />
<p class="caption">
Figure 4.2: yield del tesoro de los Estados Unidos con chartSeries
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t10yr.df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(t10yr)

t10yr.df &lt;-<span class="st"> </span>t10yr.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">fecha =</span> <span class="kw">as.Date</span>(<span class="kw">rownames</span>(t10yr.df))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">            </span><span class="kw">na.omit</span>()

g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> t10yr.df,<span class="kw">aes</span>(<span class="dt">x =</span> fecha , <span class="dt">y =</span> DGS10)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>)
g3 &lt;-<span class="st"> </span>g3 <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;10-Year US Treasury Yields&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Desde 2000-01-01 hasta 2018-04-17&quot;</span>)
g3 &lt;-<span class="st"> </span>g3 <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Fecha&quot;</span>) <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Yield(%)&quot;</span>) 
g3 &lt;-<span class="st"> </span>g3 <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="fl">.5</span>),
                              <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#d3d3d3&quot;</span>))
g3</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-42"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-42-1.png" alt="yield del tesoro de los Estados Unidos con ggplot2" width="672" />
<p class="caption">
Figure 4.3: yield del tesoro de los Estados Unidos con ggplot2
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Guarmados gráfico</span>
<span class="kw">ggsave</span>(<span class="st">&quot;treasury-yields.png&quot;</span>,<span class="dt">width =</span> <span class="fl">8.5</span>, <span class="dt">height =</span> <span class="fl">4.5</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</code></pre></div>
</div>
<div id="duracion-y-convexidad-de-un-bono" class="section level2">
<h2><span class="header-section-number">4.6</span> Duración y Convexidad de un Bono</h2>
<div id="extracion-de-la-yield" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Extración de la yield</h3>
<p>La función subset se explica sola, permite extraer una parte de tu base según un criterio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extraemos un valor en específico</span>
t10yr_yield &lt;-<span class="st"> </span>t10yr.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">               </span><span class="kw">subset</span>(fecha <span class="op">==</span><span class="st"> &quot;2017-03-03&quot;</span>) 

t10yr_yield &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(t10yr_yield<span class="op">$</span>DGS10)<span class="op">*</span><span class="fl">0.01</span>  </code></pre></div>
</div>
<div id="duracion" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Duración</h3>
<p>Existen dos Duraciones, la de Macaulay y modificada (o de Hicks), las que miden sensibilidad del precio ante cambios de la yield.</p>
<p>Macaulay:</p>


<p>Modificada:</p>


<p>Aprox. Duración Modificada:</p>

<div id="duracion-macaulay" class="section level4">
<h4><span class="header-section-number">4.6.2.1</span> Duración Macaulay</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># duracion de Macaulay</span>
macaulay &lt;-<span class="st"> </span><span class="cf">function</span>(y,n,c,t,T){
         mac &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>y)<span class="op">/</span>y <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">+</span>(n<span class="op">*</span>(c<span class="op">-</span>y)))<span class="op">/</span>(c<span class="op">*</span>((<span class="dv">1</span><span class="op">+</span>y)<span class="op">^</span>n <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>y)
         <span class="kw">print</span>(mac)
} </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">macaulay &lt;-<span class="st"> </span><span class="kw">macaulay</span>(t10yr_yield,<span class="dv">10</span>,<span class="fl">0.03</span>)</code></pre></div>
<pre><code>## [1] 8.817</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">macaulay</code></pre></div>
<pre><code>## [1] 8.817</code></pre>
</div>
<div id="duracion-modificada" class="section level4">
<h4><span class="header-section-number">4.6.2.2</span> Duración Modificada</h4>
<p>Duración Modificada:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># duración modificada</span>
modificada &lt;-<span class="st"> </span>macaulay<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>t10yr_yield)
modificada </code></pre></div>
<pre><code>## [1] 8.603</code></pre>
</div>
<div id="aproximacion-duracion-modificada" class="section level4">
<h4><span class="header-section-number">4.6.2.3</span> Aproximación Duración Modificada</h4>
<p>Aproximación Duración Modificada:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Para la aproximación de la duración modificada</span>
precio.arriba &lt;-<span class="st"> </span><span class="kw">precio.bono</span>(<span class="dt">p =</span> <span class="dv">100</span>, <span class="dt">tc =</span> <span class="fl">0.03</span>, <span class="dt">t =</span> <span class="dv">10</span>, <span class="dt">y =</span> t10yr_yield <span class="op">+</span><span class="st"> </span><span class="fl">0.01</span>)
precio        &lt;-<span class="st"> </span><span class="kw">precio.bono</span>(<span class="dt">p =</span> <span class="dv">100</span>, <span class="dt">tc =</span> <span class="fl">0.03</span>, <span class="dt">t =</span> <span class="dv">10</span>, <span class="dt">y =</span> t10yr_yield)
precio.abajo  &lt;-<span class="st"> </span><span class="kw">precio.bono</span>(<span class="dt">p =</span> <span class="dv">100</span>, <span class="dt">tc =</span> <span class="fl">0.03</span>, <span class="dt">t =</span> <span class="dv">10</span>, <span class="dt">y =</span> t10yr_yield <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculo de aproximación duración modificada</span>
aprox.dur.mod &lt;-<span class="st"> </span>(precio.abajo <span class="op">-</span><span class="st"> </span>precio.arriba)<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>precio <span class="op">*</span><span class="st"> </span><span class="fl">0.01</span>)
aprox.dur.mod</code></pre></div>
<pre><code>## [1] 8.62</code></pre>
</div>
</div>
<div id="duracion-con-libreria" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Duración con librería</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Con librerias</span>
<span class="kw">p_load</span>(<span class="st">&quot;derivmkts&quot;</span>)

<span class="co"># Duración moficada </span>
<span class="kw">duration</span>(precio, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">modified =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 8.603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Duración Macaulay</span>
<span class="kw">duration</span>(precio, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">modified =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 8.817</code></pre>
</div>
<div id="convexidad" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Convexidad</h3>
<p><span class="math display">\[
\text{Convexidad} = \frac{1}{P \times (1+y)^2} \sum_{t=1}^{T} \bigg[ \frac{CF_{t}}{(1 + y)^t } (t^2 + t) \bigg]
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(P\)</span> : Precio Bono.</li>
<li><span class="math inline">\(y\)</span> : <em>yield to maturity</em>.</li>
<li><span class="math inline">\(T\)</span> : Madurez en años.</li>
<li><span class="math inline">\(CF_{t}\)</span> : <em>Cash flow</em> en el tiempo <span class="math inline">\(t\)</span>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculamos medida de convexidad</span>
convexidad &lt;-<span class="st"> </span>(precio.arriba <span class="op">+</span><span class="st"> </span>precio.abajo  <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>precio)<span class="op">/</span>(precio <span class="op">*</span><span class="st"> </span>(<span class="fl">0.01</span>)<span class="op">^</span><span class="dv">2</span>)
convexidad</code></pre></div>
<pre><code>## [1] 88.45</code></pre>
<div id="aproximacion-duracion-modificada-1" class="section level4">
<h4><span class="header-section-number">4.6.4.1</span> Aproximación Duración Modificada</h4>
<p><span class="math display">\[
\text{Aproximacion Convexidad} = \frac{P_{+} - P_{-} - 2P_{0}}{2P_{0}(\Delta y)^2}
\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(P_{0}\)</span> : Precio del Bono.</li>
<li><span class="math inline">\(P_{-}\)</span> : Precio del Bono cuando la tasa de interes aumenta.</li>
<li><span class="math inline">\(P_{+}\)</span> : Precio del Bono cuando la tasa de interes disminuye.</li>
<li><span class="math inline">\(\Delta y\)</span> : Cambio en la tasa de interes.</li>
</ul>
</div>
</div>
<div id="convexidad-con-libreria" class="section level3">
<h3><span class="header-section-number">4.6.5</span> Convexidad con librería:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">convexity</span>(precio, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 88.34</code></pre>
</div>
</div>
<div id="efecto-dolar" class="section level2">
<h2><span class="header-section-number">4.7</span> Efecto Dolar</h2>
<p><span class="math display">\[
\text{Efecto Dolar} = \Delta P_{duration} + \Delta P_{convexity}  
\]</span> Donde:</p>
<p><span class="math display">\[
\text{Duration Dollar Change} = -D \times \Delta y \times P 
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(D\)</span> : Duración.</li>
<li><span class="math inline">\(\Delta y\)</span> : Cambio en la <em>yield</em>.</li>
<li><span class="math inline">\(P\)</span> : Precio Bono.</li>
</ul>
<p><span class="math display">\[
\text{Convexity Dollar Change} = 0.5 \times C \times (\Delta y)^2 \times P 
\]</span> Donde:</p>
<ul>
<li><span class="math inline">\(C\)</span> : Convexidad.</li>
<li><span class="math inline">\((\Delta y)^2\)</span> : Cambio en la <em>yield</em> al cuadrado.</li>
<li><span class="math inline">\(P\)</span> : Precio Bono.</li>
</ul>
</div>
<div id="ejercicio" class="section level2">
<h2><span class="header-section-number">4.8</span> Ejercicio</h2>
</div>
<div id="recursos-del-capitulo-1" class="section level2">
<h2><span class="header-section-number">4.9</span> Recursos del capítulo</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="portafolio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="options.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Bonos.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
